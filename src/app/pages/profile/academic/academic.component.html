<app-navbar></app-navbar>

<div class="mt-24 p-6 min-h-screen flex flex-col items-center bg-gray-50">
  <div
    class="container w-full max-w-9xl bg-white shadow-2xl rounded-2xl p-6 md:p-10"
  >
    <h1 class="text-4xl font-extrabold text-blue-700 mb-6 text-center">
      üë©‚Äçüè´ Acad√©micos
    </h1>

    <!-- üîç Filtros -->
    <div
      *ngIf="!selectedAcademic && !loading && !error"
      class="flex flex-col md:flex-row justify-between items-center gap-4 mb-8"
    >
      <div class="flex gap-2 w-full md:w-1/2">
        <input
          type="text"
          [(ngModel)]="searchText"
          placeholder="Buscar por nombre..."
          class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-400 focus:outline-none"
        />
      </div>

      <div class="flex gap-2 w-full md:w-1/2">
        <select
          [(ngModel)]="searchEspecialidad"
          class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-400 focus:outline-none"
        >
          <option value="">Todas las especialidades</option>
          <option *ngFor="let asig of especialidades" [value]="asig">
            {{ asig }}
          </option>
        </select>
        <button
          (click)="clearFilters()"
          class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition"
        >
          Limpiar
        </button>
      </div>
    </div>

    <!-- ‚è≥ Cargando -->
    <div *ngIf="loading" class="text-center text-gray-500 py-10">
      Cargando acad√©micos...
    </div>

    <!-- ‚ö†Ô∏è Error -->
    <div *ngIf="error" class="text-center text-red-500 font-semibold py-10">
      {{ error }}
    </div>

    <!-- üìã Lista de acad√©micos -->
    <div
      *ngIf="!selectedAcademic && !loading && !error"
      class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-8"
    >
      <div
        *ngFor="let a of filteredAcademics()"
        (click)="selectedAcademic = a"
        class="cursor-pointer academic-card bg-gray-50 hover:bg-blue-50 rounded-2xl shadow-md p-4 flex flex-col items-center transition duration-300"
      >
        <img
          [src]="a.fotoPerfil"
          (click)="openImageModal(a.fotoPerfil)"
          alt="Foto de {{ a.nombre }}"
          class="w-42 h-42 rounded-full mb-4 object-cover shadow-lg"
        />
        <h2 class="text-xl font-bold text-gray-800 text-center">
          {{ a.nombre }}
        </h2>
        <p class="text-blue-600 font-medium text-center">
          {{ a.especialidad }}
        </p>
      </div>
    </div>

    <!-- üßç Detalle del acad√©mico -->
    <div *ngIf="selectedAcademic && !loading && !error" class="mt-6">
      <div
        class="bg-gray-50 rounded-xl shadow-lg p-6 flex flex-col md:flex-row gap-8"
      >
        <img
          [src]="selectedAcademic.fotoPerfil"
          (click)="openImageModal(selectedAcademic.fotoPerfil)"
          alt="Foto de {{ selectedAcademic.nombre }}"
          class="w-62 h-auto rounded-full object-cover mx-auto md:mx-0 shadow-md cursor-pointer hover:scale-105 transition"
        />

        <div class="flex-1">
          <h2 class="text-3xl font-bold text-gray-800 mb-4">
            {{ selectedAcademic.nombre }}
          </h2>

          <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
            <div class="flex flex-col gap-1">
              <h4 class="text-sm font-semibold text-gray-600 ml-1">Rol</h4>
              <div class="bg-gray-100 p-4 rounded-lg shadow-inner">
                <p class="text-gray-800 text-xl">
                  {{ selectedAcademic.rol || "‚Äî" }}
                </p>
              </div>
            </div>

            <div class="flex flex-col gap-1">
              <h4 class="text-sm font-semibold text-gray-600 ml-1">
                Departamento
              </h4>
              <div class="bg-gray-100 p-4 rounded-lg shadow-inner">
                <p class="text-gray-800 text-xl">
                  {{ selectedAcademic.departamento || "‚Äî" }}
                </p>
              </div>
            </div>

            <div class="flex flex-col gap-1">
              <h4 class="text-sm font-semibold text-gray-600 ml-1">Oficina</h4>
              <div class="bg-gray-100 p-4 rounded-lg shadow-inner">
                <p class="text-gray-800 text-xl">
                  {{ selectedAcademic.oficina || "‚Äî" }}
                </p>
              </div>
            </div>

            <div class="flex flex-col gap-1">
              <h4 class="text-sm font-semibold text-gray-600 ml-1">Email</h4>
              <div class="bg-gray-100 p-4 rounded-lg shadow-inner">
                <p class="text-gray-800 text-xl break-words">
                  {{ selectedAcademic.email || "‚Äî" }}
                </p>
              </div>
            </div>

            <div class="flex flex-col gap-1">
              <h4 class="text-sm font-semibold text-gray-600 ml-1">Anexo</h4>
              <div class="bg-gray-100 p-4 rounded-lg shadow-inner">
                <p class="text-gray-800 text-xl">
                  {{ selectedAcademic.anexo || "‚Äî" }}
                </p>
              </div>
            </div>

            <div class="flex flex-col gap-1">
              <h4 class="text-sm font-semibold text-gray-600 ml-1">
                Especialidad
              </h4>
              <div class="bg-gray-100 p-4 rounded-lg shadow-inner">
                <p class="text-gray-800 text-xl">
                  {{ selectedAcademic.especialidad || "‚Äî" }}
                </p>
              </div>
            </div>
          </div>

          <!-- Botones de acci√≥n -->
          <div class="mt-8 flex flex-wrap items-center gap-4">
            <button
              *ngIf="selectedAcademic.oficinaImagen"
              (click)="openImageModal(selectedAcademic.oficinaImagen)"
              class="px-7 py-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-xl font-bold shadow-md"
            >
              Mapa Oficina
            </button>
            <button
              *ngIf="selectedAcademic.horarioImagen"
              (click)="openImageModal(selectedAcademic.horarioImagen)"
              class="px-7 py-4 bg-green-600 text-white rounded-lg hover:bg-green-700 text-xl font-bold shadow-md"
            >
              Ver horario
            </button>
            <!-- Espaciador para empujar el bot√≥n de volver a la derecha -->
            <div class="flex-grow"></div>
            <button
              (click)="selectedAcademic = undefined"
              class="px-7 py-4 bg-gray-600 text-white rounded-lg hover:bg-gray-700 text-xl font-bold shadow-md"
            >
              Volver
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- üñº Modal imagen -->
    <div
      *ngIf="modalOpen"
      class="fixed inset-0 bg-black/70 flex items-center justify-center z-50"
      (click)="closeModal()"
    >
      <img
        [src]="modalImage"
        alt="Imagen ampliada"
        class="max-w-4xl max-h-[90vh] rounded-lg shadow-2xl border-4 border-white object-contain"
        (click)="$event.stopPropagation()"
      />
    </div>
  </div>
</div>

<app-footer></app-footer>
